var We=Object.defineProperty;var Xe=(e,t,n)=>t in e?We(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ye=(e,t,n)=>(Xe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function x(){}function He(e){return e()}function Ae(){return Object.create(null)}function ee(e){e.forEach(He)}function Ke(e){return typeof e=="function"}function Ye(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ze(e){return Object.keys(e).length===0}function c(e,t){e.appendChild(t)}function ve(e,t,n){e.insertBefore(t,n||null)}function re(e){e.parentNode&&e.parentNode.removeChild(e)}function Pe(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function F(e){return document.createTextNode(e)}function I(){return F(" ")}function H(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function w(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function $e(e){return Array.from(e.childNodes)}function Ce(e,t){t=""+t,e.data!==t&&(e.data=t)}function oe(e,t){e.value=t??""}function ge(e,t,n){for(let l=0;l<e.options.length;l+=1){const o=e.options[l];if(o.__value===t){o.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Fe(e){const t=e.querySelector(":checked");return t&&t.__value}let ie;function se(e){ie=e}function xe(){if(!ie)throw new Error("Function called outside component initialization");return ie}function et(e){xe().$$.on_mount.push(e)}const Z=[],me=[];let $=[];const Ue=[],tt=Promise.resolve();let ke=!1;function nt(){ke||(ke=!0,tt.then(Je))}function ce(e){$.push(e)}const we=new Set;let X=0;function Je(){if(X!==0)return;const e=ie;do{try{for(;X<Z.length;){const t=Z[X];X++,se(t),lt(t.$$)}}catch(t){throw Z.length=0,X=0,t}for(se(null),Z.length=0,X=0;me.length;)me.pop()();for(let t=0;t<$.length;t+=1){const n=$[t];we.has(n)||(we.add(n),n())}$.length=0}while(Z.length);for(;Ue.length;)Ue.pop()();ke=!1,we.clear(),se(e)}function lt(e){if(e.fragment!==null){e.update(),ee(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ce)}}function st(e){const t=[],n=[];$.forEach(l=>e.indexOf(l)===-1?t.push(l):n.push(l)),n.forEach(l=>l()),$=t}const ot=new Set;function Qe(e,t){e&&e.i&&(ot.delete(e),e.i(t))}function Y(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function it(e,t){e.d(1),t.delete(e.key)}function ct(e,t,n,l,o,i,u,d,O,_,v,y){let p=e.length,E=i.length,a=p;const N={};for(;a--;)N[e[a].key]=a;const k=[],D=new Map,L=new Map,j=[];for(a=E;a--;){const b=y(o,i,a),g=n(b);let S=u.get(g);S?j.push(()=>S.p(b,t)):(S=_(g,b),S.c()),D.set(g,k[a]=S),g in N&&L.set(g,Math.abs(a-N[g]))}const R=new Set,U=new Set;function B(b){Qe(b,1),b.m(d,v),u.set(b.key,b),v=b.first,E--}for(;p&&E;){const b=k[E-1],g=e[p-1],S=b.key,P=g.key;b===g?(v=b.first,p--,E--):D.has(P)?!u.has(S)||R.has(S)?B(b):U.has(P)?p--:L.get(S)>L.get(P)?(U.add(S),B(b)):(R.add(P),p--):(O(g,u),p--)}for(;p--;){const b=e[p];D.has(b.key)||O(b,u)}for(;E;)B(k[E-1]);return ee(j),k}function rt(e,t,n){const{fragment:l,after_update:o}=e.$$;l&&l.m(t,n),ce(()=>{const i=e.$$.on_mount.map(He).filter(Ke);e.$$.on_destroy?e.$$.on_destroy.push(...i):ee(i),e.$$.on_mount=[]}),o.forEach(ce)}function ut(e,t){const n=e.$$;n.fragment!==null&&(st(n.after_update),ee(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function at(e,t){e.$$.dirty[0]===-1&&(Z.push(e),nt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ft(e,t,n,l,o,i,u=null,d=[-1]){const O=ie;se(e);const _=e.$$={fragment:null,ctx:[],props:i,update:x,not_equal:o,bound:Ae(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(O?O.$$.context:[])),callbacks:Ae(),dirty:d,skip_bound:!1,root:t.target||O.$$.root};u&&u(_.root);let v=!1;if(_.ctx=n?n(e,t.props||{},(y,p,...E)=>{const a=E.length?E[0]:p;return _.ctx&&o(_.ctx[y],_.ctx[y]=a)&&(!_.skip_bound&&_.bound[y]&&_.bound[y](a),v&&at(e,y)),p}):[],_.update(),v=!0,ee(_.before_update),_.fragment=l?l(_.ctx):!1,t.target){if(t.hydrate){const y=$e(t.target);_.fragment&&_.fragment.l(y),y.forEach(re)}else _.fragment&&_.fragment.c();t.intro&&Qe(e.$$.fragment),rt(e,t.target,t.anchor),Je()}se(O)}class dt{constructor(){ye(this,"$$");ye(this,"$$set")}$destroy(){ut(this,1),this.$destroy=x}$on(t,n){if(!Ke(n))return x;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(t){this.$$set&&!Ze(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const pt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(pt);const ht=["webm","ogg","mp4","x-matroska"],_t=["should-not-be-supported","vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h.265","h264","h.264","opus","pcm","aac","mpeg","mp4a"];function gt(e){const t=ht,n=MediaRecorder.isTypeSupported,l=[];return t.forEach(o=>{const i=`${e}/${o}`;_t.forEach(u=>[`${i};codecs=${u}`,`${i};codecs=${u.toUpperCase()}`].forEach(d=>{n(d)&&l.push(d)})),n(i)&&l.push(i)}),l}function Be(e,t,n){const l=e.slice();return l[33]=t[n],l}function De(e,t,n){const l=e.slice();return l[36]=t[n],l}function qe(e,t,n){const l=e.slice();return l[39]=t[n],l}function Ve(e){let t,n,l=e[39]+"",o,i;return{c(){t=h("p"),n=F("- "),o=F(l),w(t,"class",i=e[39].includes("encoder log:")?"encoder-log":"")},m(u,d){ve(u,t,d),c(t,n),c(t,o)},p(u,d){d[0]&2048&&l!==(l=u[39]+"")&&Ce(o,l),d[0]&2048&&i!==(i=u[39].includes("encoder log:")?"encoder-log":"")&&w(t,"class",i)},d(u){u&&re(t)}}}function ze(e,t){let n,l=t[36].label+"",o,i;return{key:e,first:null,c(){n=h("option"),o=F(l),n.__value=i=t[36],oe(n,n.__value),this.first=n},m(u,d){ve(u,n,d),c(n,o)},p(u,d){t=u,d[0]&2&&l!==(l=t[36].label+"")&&Ce(o,l),d[0]&2&&i!==(i=t[36])&&(n.__value=i,oe(n,n.__value))},d(u){u&&re(n)}}}function Ge(e){let t,n=e[33]+"",l;return{c(){t=h("option"),l=F(n),t.__value=e[33],oe(t,t.__value)},m(o,i){ve(o,t,i),c(t,l)},p:x,d(o){o&&re(t)}}}function mt(e){let t,n,l,o,i,u,d,O,_,v,y,p,E,a,N,k=[],D=new Map,L,j,R,U,B,b,g,S,P,A,C,V,q,ue,K,ae,te,fe,f,z,Me,de,Te,G,Oe,pe,Re,ne,Le,he,Ie,J,be,Ne,Q=Y(e[11]),M=[];for(let s=0;s<Q.length;s+=1)M[s]=Ve(qe(e,Q,s));let _e=Y(e[1]);const je=s=>s[36].deviceId;for(let s=0;s<_e.length;s+=1){let m=De(e,_e,s),r=je(m);D.set(r,k[s]=ze(r,m))}let W=Y(e[13]),T=[];for(let s=0;s<W.length;s+=1)T[s]=Ge(Be(e,W,s));return{c(){t=h("div"),n=h("div"),l=h("p"),l.textContent="logs",o=I();for(let s=0;s<M.length;s+=1)M[s].c();i=I(),u=h("main"),d=h("div"),O=h("p"),O.textContent="Input and Stream",_=I(),v=h("div"),y=h("button"),p=F("Get input sources"),E=I(),a=h("select"),N=h("option"),N.textContent="Select input device";for(let s=0;s<k.length;s+=1)k[s].c();j=I(),R=h("button"),U=F("Start stream"),b=I(),g=h("div"),S=h("p"),S.textContent="Media Recorder Configuration",P=I(),A=h("div"),C=h("select"),V=h("option"),V.textContent="Select mimeType";for(let s=0;s<T.length;s+=1)T[s].c();ue=I(),K=h("div"),ae=F("Frames captured: "),te=F(e[10]),fe=I(),f=h("div"),z=h("button"),Me=F("Start capture"),Te=I(),G=h("button"),Oe=F("Stop capture"),Re=I(),ne=h("button"),ne.textContent="Reset",Le=I(),he=h("video"),he.innerHTML='<track kind="captions"/>',Ie=I(),J=h("canvas"),w(l,"class","font-bold"),w(n,"class","col-span-1 bg-slate-200 p-4 font-mono text-sm overflow-hiden overflow-y-scroll"),w(O,"class","text-slate-50 underline svelte-ktit73"),y.disabled=e[3],w(y,"class","svelte-ktit73"),N.__value="Select input device",oe(N,N.__value),w(a,"class","self-stretch svelte-ktit73"),a.disabled=L=!e[3],e[2]===void 0&&ce(()=>e[18].call(a)),R.disabled=B=!e[3],w(R,"class","svelte-ktit73"),w(v,"class","flex items-start gap-4 svelte-ktit73"),w(d,"class","contain svelte-ktit73"),w(S,"class","text-slate-50 underline svelte-ktit73"),V.__value="Select mimeType",oe(V,V.__value),C.disabled=q=!e[6],w(C,"class","svelte-ktit73"),e[0]===void 0&&ce(()=>e[19].call(C)),w(A,"class","flex items-start gap-4 svelte-ktit73"),z.disabled=de=e[9]||e[8]||!e[4]||!e[6],w(z,"class","svelte-ktit73"),G.disabled=pe=e[8]||!e[6],w(G,"class","svelte-ktit73"),w(ne,"class","svelte-ktit73"),w(f,"class","flex items-center gap-4 svelte-ktit73"),w(g,"class","contain svelte-ktit73"),J.hidden=!0,w(J,"height",Se),w(J,"width",Ee),w(u,"class","col-span-4 bg-slate-800 p-4 space-y-4"),w(t,"class","grid grid-cols-5 grow")},m(s,m){ve(s,t,m),c(t,n),c(n,l),c(n,o);for(let r=0;r<M.length;r+=1)M[r]&&M[r].m(n,null);c(t,i),c(t,u),c(u,d),c(d,O),c(d,_),c(d,v),c(v,y),c(y,p),c(v,E),c(v,a),c(a,N);for(let r=0;r<k.length;r+=1)k[r]&&k[r].m(a,null);ge(a,e[2],!0),c(v,j),c(v,R),c(R,U),c(u,b),c(u,g),c(g,S),c(g,P),c(g,A),c(A,C),c(C,V);for(let r=0;r<T.length;r+=1)T[r]&&T[r].m(C,null);ge(C,e[0],!0),c(A,ue),c(A,K),c(K,ae),c(K,te),c(g,fe),c(g,f),c(f,z),c(z,Me),c(f,Te),c(f,G),c(G,Oe),c(f,Re),c(f,ne),c(u,Le),c(u,he),e[20](he),c(u,Ie),c(u,J),e[21](J),be||(Ne=[H(y,"click",e[12]),H(a,"change",e[18]),H(R,"click",e[14]),H(C,"change",e[19]),H(z,"click",e[15]),H(G,"click",e[16]),H(ne,"click",e[17])],be=!0)},p(s,m){if(m[0]&2048){Q=Y(s[11]);let r;for(r=0;r<Q.length;r+=1){const le=qe(s,Q,r);M[r]?M[r].p(le,m):(M[r]=Ve(le),M[r].c(),M[r].m(n,null))}for(;r<M.length;r+=1)M[r].d(1);M.length=Q.length}if(m[0]&8&&(y.disabled=s[3]),m[0]&2&&(_e=Y(s[1]),k=ct(k,m,je,1,s,_e,D,a,it,ze,null,De)),m[0]&8&&L!==(L=!s[3])&&(a.disabled=L),m[0]&6&&ge(a,s[2]),m[0]&8&&B!==(B=!s[3])&&(R.disabled=B),m[0]&8192){W=Y(s[13]);let r;for(r=0;r<W.length;r+=1){const le=Be(s,W,r);T[r]?T[r].p(le,m):(T[r]=Ge(le),T[r].c(),T[r].m(C,null))}for(;r<T.length;r+=1)T[r].d(1);T.length=W.length}m[0]&64&&q!==(q=!s[6])&&(C.disabled=q),m[0]&8193&&ge(C,s[0]),m[0]&1024&&Ce(te,s[10]),m[0]&848&&de!==(de=s[9]||s[8]||!s[4]||!s[6])&&(z.disabled=de),m[0]&320&&pe!==(pe=s[8]||!s[6])&&(G.disabled=pe)},i:x,o:x,d(s){s&&re(t),Pe(M,s);for(let m=0;m<k.length;m+=1)k[m].d();Pe(T,s),e[20](null),e[21](null),be=!1,ee(Ne)}}}let Se=1080,Ee=1920;function vt(e,t,n){function l(f){console.log(f),n(11,q=[...q,f])}et(async()=>{l("page loaded")});let o=[],i,u=!1,d=!1;async function O(){u||(await navigator.mediaDevices.getUserMedia({video:!0}),u=!0),n(1,o=(await navigator.mediaDevices.enumerateDevices()).filter(f=>f.kind==="videoinput")),n(3,d=!0),l("input sources fetched")}let _=gt("video"),v="Select mimeType",y=!1,p,E,a=!1;async function N(){n(6,a=!1),n(5,p.srcObject=null,p),E&&E.getTracks().forEach(f=>f.stop());try{E=await navigator.mediaDevices.getUserMedia({video:{deviceId:i.deviceId,width:Ee,height:Se}})}catch(f){console.log(f)}n(5,p.srcObject=E,p),await p.play(),n(6,a=!0),l("stream started with "+i.label)}let k,D,L,j,R=!1,U=[];const B=()=>{console.log("stop called");const f=new Blob(U,{type:v});U=[],l("media ready"),l(URL.createObjectURL(f))};MediaRecorder.isTypeSupported("");async function b(){L=k.getContext("2d"),D=k.captureStream(),j=new MediaRecorder(D,{mimeType:v}),j.addEventListener("stop",B),l("media recorder configured"),R=!0}let g=!1,S=!1,P=!1,A=1;async function C(){if(!P){if(R||b(),!L)throw new Error("No rendering context availabe");j.state==="inactive"&&j.start(),S||(n(9,S=!0),l("capturing video stream")),L.clearRect(0,0,Ee,Se),L.drawImage(p,0,0),console.log("captured",A,"frames"),n(10,A++,A),p.requestVideoFrameCallback(C)}}async function V(){l("beginning encoding"),P=!0,n(9,S=!1),n(8,g=!0),j.ondataavailable=({data:f})=>{console.log("data available",f),U.push(f)},j.stop(),n(8,g=!1)}let q=[];function ue(){n(11,q=[]),n(0,v="Select mimeType"),n(4,y=!1),n(6,a=!1),R=!1,U=[],n(8,g=!1),n(9,S=!1),P=!1,n(10,A=1)}function K(){i=Fe(this),n(2,i),n(1,o)}function ae(){v=Fe(this),n(0,v),n(13,_)}function te(f){me[f?"unshift":"push"](()=>{p=f,n(5,p)})}function fe(f){me[f?"unshift":"push"](()=>{k=f,n(7,k)})}return e.$$.update=()=>{e.$$.dirty[0]&1&&n(4,y=MediaRecorder.isTypeSupported(v))},[v,o,i,d,y,p,a,k,g,S,A,q,O,_,N,C,V,ue,K,ae,te,fe]}class bt extends dt{constructor(t){super(),ft(this,t,vt,mt,Ye,{},null,[-1,-1])}}new bt({target:document.getElementById("app")});
